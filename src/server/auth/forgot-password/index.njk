{% extends "layouts/page.njk" %}
{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

      {# Build error summary list #}
      {% set errorList = [] %}
      {% if fieldErrors.email == ERROR_CODES.EMAIL_REQUIRED %}
        {% set errorList = errorList.concat([{ text: t('auth.validation.email.required'), href: "#email" }]) %}
      {% elif fieldErrors.email == ERROR_CODES.EMAIL_INVALID_FORMAT or fieldErrors.email == ERROR_CODES.EMAIL_TOO_LONG %}
        {% set errorList = errorList.concat([{ text: t('auth.validation.email.invalid_format'), href: "#email" }]) %}
      {% endif %}

      {% if errorList.length > 0 %}
        {{ govukErrorSummary({
          titleText: t('common.error_summary_title'),
          errorList: errorList
        }) }}
      {% endif %}

      <h1 class="govuk-heading-xl">
        {{ t('auth.forgot_password.heading') }}
      </h1>

      <p class="govuk-body">
        {{ t('auth.forgot_password.description') }}
      </p>

      <form action="/forgot-password" method="post" novalidate>

        {# Email field error #}
        {% set emailError = false %}
        {% if fieldErrors.email == ERROR_CODES.EMAIL_REQUIRED %}
          {% set emailError = { text: t('auth.validation.email.required') } %}
        {% elif fieldErrors.email == ERROR_CODES.EMAIL_INVALID_FORMAT or fieldErrors.email == ERROR_CODES.EMAIL_TOO_LONG %}
          {% set emailError = { text: t('auth.validation.email.invalid_format') } %}
        {% endif %}

        {{ govukInput({
          label: {
            text: t('auth.labels.email')
          },
          classes: "govuk-!-width-two-thirds",
          id: "email",
          name: "email",
          type: "email",
          autocomplete: "email",
          value: email,
          spellcheck: false,
          errorMessage: emailError
        }) }}

        {{ govukButton({
          text: t('auth.forgot_password.submit_button')
        }) }}

      </form>

      <p class="govuk-body govuk-!-margin-top-6">
        <a href="/login" class="govuk-link">{{ t('common.back_to_sign_in') }}</a>
      </p>

    </div>
  </div>
{% endblock %}
