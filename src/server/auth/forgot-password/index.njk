{% extends "layouts/page.njk" %}
{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

      {# Validation errors #}
      {% if validationErrors %}
        {% set errorList = [] %}
        {% for error in validationErrors %}
          {% if error == "email-required" %}
            {% set errorList = errorList.concat([
              {
                text: t('password-reset.forgot_password.errors.email_required'),
                href: "#email"
              }
            ]) %}
          {% elif error == "email-invalid" %}
            {% set errorList = errorList.concat([
              {
                text: t('password-reset.forgot_password.errors.email_invalid'),
                href: "#email"
              }
            ]) %}
          {% endif %}
        {% endfor %}

        {% if errorList.length > 0 %}
          {{ govukErrorSummary({
            titleText: t('common.error_summary_title'),
            errorList: errorList
          }) }}
        {% endif %}
      {% endif %}

      <h1 class="govuk-heading-xl">
        {{ t('password-reset.forgot_password.heading') }}
      </h1>

      <p class="govuk-body">
        {{ t('password-reset.forgot_password.description') }}
      </p>

      <form action="/forgot-password" method="post" novalidate>

        {% set emailErrorMessage = false %}
        {% if validationErrors %}
          {% for error in validationErrors %}
            {% if error == "email-required" %}
              {% set emailErrorMessage = {
                text: t('password-reset.forgot_password.errors.email_required')
              } %}
            {% elif error == "email-invalid" %}
              {% set emailErrorMessage = {
                text: t('password-reset.forgot_password.errors.email_invalid')
              } %}
            {% endif %}
          {% endfor %}
        {% endif %}

        {{ govukInput({
          label: {
            text: t('password-reset.forgot_password.email_label')
          },
          classes: "govuk-!-width-two-thirds",
          id: "email",
          name: "email",
          type: "email",
          autocomplete: "email",
          value: email,
          spellcheck: false,
          errorMessage: emailErrorMessage
        }) }}

        {{ govukButton({
          text: t('password-reset.forgot_password.submit_button')
        }) }}

      </form>

      <p class="govuk-body govuk-!-margin-top-6">
        <a href="/login" class="govuk-link">{{ t('password-reset.forgot_password.back_to_sign_in') }}</a>
      </p>

    </div>
  </div>
{% endblock %}
